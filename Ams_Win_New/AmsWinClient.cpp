//---------------------------------------------------------------------------

#include "AMS_HDR.h"
#pragma hdrstop
USERES("AmsWinClient.res");
USEFORM("ams_win_c.cpp", AmsWinC);
USEFORM("FRM_BROWS_DB.cpp", FrmBrowsDb);
USEFORM("FRM_CHOOSE_OBJ.cpp", FrmChooseObj);
USEUNIT("..\COMMON\AMS_EXC.cpp");
USEFORM("FRM_EDIT_DB_POS.cpp", FrmEditDbPos);
USEFORM("FRM_FIND_DB_POS2.cpp", FrmFindDbPos);
USEUNIT("..\COMP\GET_DB_POS.cpp");
USEUNIT("AMS_VAL.cpp");
USEFORM("FRM_SORT_ORDER.cpp", FrmSortOrder);
USEUNIT("..\COMMON\AMS_READ_CNF.cpp");
USEFORM("FRM_QUICK_SEARCH.cpp", FrmQuickSearch);
USEFORM("..\COMMON\FRM_GET_DB_CAT.cpp", FrmGetDbCat);
USEFORM("FRM_SET_FLD.cpp", FrmSetFld);
USEFORM("..\COMMON\FRM_WINDOWS_LIST.cpp", FrmWindowsList);
USEFORM("FRM_CHOOSE_DB_POS.cpp", FrmChooseDbPos);
USEFORM("FRM_HIST_VIEW.cpp", FrmHistView);
USEFORM("FRM_HIST_BRWS.cpp", FrmHistBrws);
USEUNIT("..\COMMON\FLDS_DESCR.cpp");
USEUNIT("ADD_MODULE.cpp");
USEUNIT("Scrneng.cpp");
USEUNIT("Amsoraru.cpp");
USEUNIT("Analytic.cpp");
USEUNIT("Anprog.cpp");
USEUNIT("Basew32.cpp");
USEUNIT("Bookrus1.cpp");
USEUNIT("Date.cpp");
USEUNIT("Intpost.cpp");
USEUNIT("Orcflds.cpp");
USEUNIT("orcpp.cpp");
USEUNIT("Progcomp.cpp");
USEUNIT("Progfunc.cpp");
USEUNIT("Proglex.cpp");
USEUNIT("Progmisc.cpp");
USEUNIT("Progora.cpp");
USEUNIT("Progpipe.cpp");
USEUNIT("Progrun.cpp");
USEUNIT("Rctype.cpp");
USEUNIT("Useprog.cpp");
USEUNIT("Sumtext.cpp");
USEUNIT("Syntbl.cpp");
USEUNIT("Sum.cpp");
USEUNIT("Strlist.cpp");
USEFORM("..\COMMON\FRM_SEL_LIST.cpp", FrmSelList);
USEFORM("..\COMMON\FRM_EDIT_MEMO.cpp", FrmEditMemo);
USEUNIT("..\COMMON\THREAD_READ_FILE.cpp");
USEFORM("..\common\FRM_ASK_ACC_CODE.cpp", FrmAskAccCode);
USEFORM("FRM_INPUT_OPER.cpp", FrmInputOper);
USEFORM("FRM_PERIOD.cpp", FrmPeriod);
USEUNIT("inp_oper_utils.cpp");
USEFORM("FRM_OPER_HIST.cpp", FrmOperHist);
USEFORM("FRM_BROWS_AN.cpp", FrmBrowsAn);
USEUNIT("..\COMMON\AMS_QUERY.cpp");
USEFORM("..\COMMON\FRM_GET_SET_NAME.cpp", FrmGetSetName);
USEUNIT("FOOTER_CNTRL.cpp");
USEFORM("FRM_FOOTER_VISIBLE.cpp", FrmFooterVisible);
USEFORM("FRM_ACC_LIST.cpp", FrmAccList);
USEUNIT("..\COMMON\UTILS.cpp");
USEFORM("FRM_ASK_ACC_ANAL.cpp", FrmAskAccAnal);
USEFORM("FRM_ASK_AN_SUM_TYPE.cpp", FrmAskAnalSumType);
USEFORM("FRM_SEL_CPS_DATE.cpp", FrmSelCpsDate);
USEUNIT("LOCAL_VARS.cpp");
USEFORM("FRM_CHOOSE_OBJ_MODAL.cpp", FrmChooseObjModal);
USELIB("..\FISC\fisc.lib");
USEFORM("FRM_BROWS_AN_MODAL.cpp", FrmBrowsAnModal);
USEFORM("FRM_CHOOSE_FORM.cpp", FrmChooseForm);
USEFORM("FRM_CHOOSE_STD_OPER.cpp", FrmChooseStdOper);
USEFORM("FRM_COND_INFO.cpp", FrmCondInfo);
USEFORM("FRM_EDIT_DB_POS_ONLY.cpp", FrmEditDbPosOnly);
USEFORM("FRM_CHOOSE_STD_OPER_MODAL.cpp", FrmChooseStdOperModal);
USEFORM("FRM_INPUT_SUM_NM.cpp", FrmInputSumNM);
USEFORM("FRM_ASK_ACC_FIRST.cpp", FrmAskAccFirst);
USEUNIT("..\COMMON\FLDS_DESCR_DISTR.cpp");
USEUNIT("BRWS_ACC_WINDOW.cpp");
USEFORM("FRM_BRWS_ACC_WINDOW.cpp", FrmBrwsAccWindow);
USEFORM("FRM_VIEW_OPTIONS_AW.cpp", FrmViewOptionsAW);
USEFORM("FRM_OPER_LIST_ROOT.cpp", FrmOperListRoot);
USEFORM("FRM_OPER_LIST.cpp", FrmOperList);
USEFORM("FRM_AN_VIEW.cpp", FrmAnView);
USEUNIT("REFRESH_ACCS.cpp");
USEFORM("FRM_ASK_ANAL_SUM_TYPE2.cpp", FrmAskAnalSumType2);
USEFORM("FRM_CHOOSE_OPER.cpp", FrmChooseOper);
USEFORM("FRM_FILTER_FORM.cpp", FrmFilterForm);
USEFORM("FRM_POST_OPERS.cpp", FrmPostOpers);
USEFORM("FRM_CALC.cpp", FrmCalc);
USEFORM("FRM_ASK_DK.cpp", FrmAskDK);
USEFORM("FRM_EDIT_OPT.cpp", FrmEditOpt);
USEFORM("FRM_ASK_FLDS_NAMES.cpp", FrmAskFldsNames);
USEFORM("FRM_ANAL_SETUP.cpp", FrmAnalSetup);
USEFORM("FRM_INS_EXCEL_IMP.cpp", FrmInsExcelImp);
USEFORM("FRM_READ_EXCEL_IMP.cpp", FrmReadExcelImp);
USEFORM("FRM_USER_OPTS.cpp", FrmUserOpts);
USEFORM("FRM_SHOW_TIED_DB.cpp", FrmShowTiedDb);
USEFORM("FRM_MSG.cpp", FrmMsg);
USEFORM("FRM_CHOOSE_NOT_PLAIN_PERIOD.cpp", FrmChooseNotPlainPeriod);
USEUNIT("AAS_OBJ.cpp");
USEUNIT("ACC_MAN.cpp");
USEUNIT("READ_FILE.cpp");
USEFORM("..\common\FRM_ASK_SUM.cpp", FrmAskSum);
USEFORM("..\common\FRM_ASK_DATE.cpp", FrmAskDate);
USEFORM("FRM_ASK_DB_AN_FLD.cpp", FrmAskDbAnFld);
USEFORM("FRM_OPER_LIST_TIED_OPERS.cpp", FrmOperListTiedOpers);
USEFORM("FRM_EXIT.cpp", FrmExit);
USEUNIT("..\COMMON\ams_utils.cpp");
USEUNIT("Impoper.cpp");
USEFORM("DAT_MOD.cpp", DatMod); /* TDataModule: File Type */
USEFORM("FRM_MAP.cpp", FrmMap);
USEFORM("AboutBoxUnit.cpp", AboutBox);
USEFORM("FRM_CUSTOM_PERIOD.cpp", FrmCustomPeriod);
//---------------------------------------------------------------------------
#include "AMS_READ_CNF.h"
//---------------------------------------------------------------------------
char DirBuff [200];
//---------------------------------------------------------------------------
WINAPI WinMain(HINSTANCE, HINSTANCE, LPSTR CL, int)
{
    try
    {
         GetCurrentDirectory(200,DirBuff);
         BaseUserName = "";
         putenv("NLS_LANG=.CL8MSWIN1251");
         Application->Initialize();
         InitCnf(CL);
         Application->Title = "Подключение к бухгалтерии";
                 Application->HelpFile = "AmsWin.hlp";
                 Application->CreateForm(__classid(TAmsWinC), &AmsWinC);
                 Application->CreateForm(__classid(TDatMod), &DatMod);
                 Application->CreateForm(__classid(TFrmAccList), &FrmAccList);
                 Application->CreateForm(__classid(TFrmCalc), &FrmCalc);
                 Application->CreateForm(__classid(TFrmExit), &FrmExit);
                 Application->CreateForm(__classid(TFrmCustomPeriod), &FrmCustomPeriod);
                 Application->Run();
    }
    catch (Exception &exception)
    {
         Application->ShowException(&exception);
    }
    return 0;
}
//---------------------------------------------------------------------------

//---------------------------------------------------------------------------

